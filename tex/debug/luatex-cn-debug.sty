% Copyright 2026 Open-Guji (https://github.com/open-guji)
%
% Licensed under the Apache License, Version 2.0 (the "License");
% you may not use this file except in compliance with the License.
% You may obtain a copy of the License at
%
%     http://www.apache.org/licenses/LICENSE-2.0
%
% Unless required by applicable law or agreed to in writing, software
% distributed under the License is distributed on an "AS IS" BASIS,
% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
% See the License for the specific language governing permissions and
% limitations under the License.

% luatex-cn-debug.sty
% Centralized debugging interface for luatex-cn
%
\NeedsTeXFormat{LaTeX2e}
\RequirePackage{expl3}
\ProvidesExplPackage {debug/luatex-cn-debug} {2026/01/27} {0.1.3} {Centralized debugging for luatex-cn}

% ============================================================================
% Initialization
% ============================================================================

\lua_now:e {
    package.loaded["debug.luatex-cn-debug"]~=~nil;
    luatex_cn_debug~=~require("debug.luatex-cn-debug");
}

% Global toggle
\bool_new:N \g_luatexcn_debug_enabled_bool

% ============================================================================
% Core Commands
% ============================================================================

\NewDocumentCommand{\LtcDebugOn}{ }
  {
    \bool_gset_true:N \g_luatexcn_debug_enabled_bool
    \lua_now:e { luatex_cn_debug.set_global_status(true) }
  }

\NewDocumentCommand{\LtcDebugOff}{ }
  {
    \bool_gset_false:N \g_luatexcn_debug_enabled_bool
    \lua_now:e { luatex_cn_debug.set_global_status(false) }
  }

\NewDocumentCommand{\LtcDebugModuleOn}{ m }
  {
    \lua_now:e { luatex_cn_debug.set_module_status("#1", true) }
  }

\NewDocumentCommand{\LtcDebugModuleOff}{ m }
  {
    \lua_now:e { luatex_cn_debug.set_module_status("#1", false) }
  }

\NewDocumentCommand{\LtcDebugColor}{ m m }
  {
    \lua_now:e { luatex_cn_debug.modules["#1"].color = "#2" }
  }

% ============================================================================
% CJK Aliases
% ============================================================================

\NewCommandCopy{\开启调试}{\LtcDebugOn}
\NewCommandCopy{\关闭调试}{\LtcDebugOff}
\NewCommandCopy{\开启调试模块}{\LtcDebugModuleOn}
\NewCommandCopy{\关闭调试模块}{\LtcDebugModuleOff}
% Keep legacy names if any (LtcDebugOn/Off are already standardized)

\endinput
