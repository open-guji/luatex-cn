% Copyright 2026 Open-Guji (https://github.com/open-guji)
%
% Licensed under the Apache License, Version 2.0 (the "License");
% you may not use this file except in compliance with the License.
% You may obtain a copy of the License at
%
%     http://www.apache.org/licenses/LICENSE-2.0
%
% Unless required by applicable law or agreed to in writing, software
% distributed under the License is distributed on an "AS IS" BASIS,
% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
% See the License for the specific language governing permissions and
% limitations under the License.

% luatex-cn-core.sty
% Core package for luatex-cn
% Includes vertical typesetting and font support
%
\NeedsTeXFormat{LaTeX2e}
\RequirePackage{expl3}
\ProvidesExplPackage {luatex-cn-core} {2026/01/26} {0.1.3} {Core features for luatex-cn}

% Check if LuaTeX is being used
\sys_if_engine_luatex:TF
  { }
  {
    \PackageError { luatex-cn-core } { This~package~requires~LuaTeX }
      { Please~compile~your~document~with~LuaLaTeX~instead~of~pdfLaTeX~or~XeLaTeX. }
  }

% ============================================================================
% Load Core Dependencies
% ============================================================================

% Core vertical typesetting engine (always loaded)
\RequirePackage{vertical/luatex-cn-vertical}

% Font auto-detection module
\RequirePackage{fonts/luatex-cn-font-autodetect}

% ============================================================================
% Interface Documentation
% ============================================================================
% This package exposes the following commands:
%
%   \Vertical[options]{content}     - Main vertical layout command (Alias: \竖排)
%   \TextBox[options]{content}      - Grid-based textbox (Alias: \文本框)
%   \Paragraph                      - Environment for grid paragraphs
%   \TextFlow{content}              - Interlinear notes (Alias: \文本流)
%   \Space[width]                   - Explicit spacing (Alias: \空格)
%
%   \cnvdebugon / \cnvdebugoff      - Debug toggle
%
% ============================================================================
% CJK Aliases and Support
% ============================================================================
% Define main English interface if not present (vertical package defines \vertical and \VerticalRTT)
\NewDocumentCommand{\Vertical}{ O{} +m } { \VerticalRTT[#1]{#2} }

% CJK Aliases are already provided by vertical/luatex-cn-vertical.sty:
% \竖排 -> \VerticalRTT
% \文本框 -> \TextBox
% \段落 -> \Paragraph
% \文本流 -> \TextFlow
% \空格 -> \Space

% Version info (synchronized with VERSION file in project root)
\tl_const:Nn \c_luatexcn_core_version_tl {0.1.3}
\cs_new:Npn \luatexcncoreversion { \c_luatexcn_core_version_tl }

% Main package initialization
\PackageInfo { luatex_cn_core } { Chinese~typesetting~core~\tl_use:N \c_luatexcn_core_version_tl \space loaded }

\ExplSyntaxOff%
%
\endinput%
