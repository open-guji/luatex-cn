# LuaTeX-cn 用户手册

`luatex-cn` 是一个专门为 LuaTeX 设计的中文排版宏包，特别增强了对古籍垂直排版（Guji Layout）和现代竖排的支持。

---

## 1. 安装与准备

### 系统要求
- **编译器**: 必须使用 `LuaLaTeX` (版本 1.10+)。不支持 pdfLaTeX 或 XeLaTeX。
- **发行版**: 推荐使用 TeX Live 2024 或更高版本。

### 字体配置
本宏包默认会尝试自动检测系统中的中文字体：
- **Windows**: 优先选择 "SimSun", "Microsoft YaHei" 或 "NSimSun"。
- **macOS**: 优先选择 "Songti SC", "Heiti SC"。
- **Linux**: 优先选择 "Noto Serif CJK SC", "WenQuanYi Zen Hei"。

详细的字体手动配置方法请参考：[FONT-SETUP.md](./FONT-SETUP.md)

---

## 2. 快速入门

### 古籍排版基础模板
创建一个 `.tex` 文件，并输入以下内容：

```latex
\documentclass[四库全书]{ltc-guji}

\begin{document}
\gujiSetup{
    book-name = {测试文献},
    chapter-title = {卷之一},
    font-size = 14pt
}

这里是正文内容。你可以直接输入中文，宏包会自动处理垂直流动和分栏。

\TextFlow{这里是双行小注，通常用于解释正文。}

\end{document}
```

使用 `lualatex` 编译即可获得带有乌丝栏和版心的古籍页面。

---

## 3. 文档类与模板

项目提供了两个主要的文档类：

### `ltc-guji.cls` (古籍专用)
包含复杂的网格、鱼尾、版心控制，适用于重现历史文献。
- **内置模板**:
    - `四库全书`: 绿/红色界面的经典官修书籍风格。
    - `红楼梦甲戌本`: 模拟手抄本，支持侧批与眉批。

### `ltc-book.cls` (现代竖排)
适用于现代小说、报告。默认无网格，版式更加自由。
- **使用环境**: 使用 `\begin{正文} ... \end{正文}` 包裹内容。

---

## 4. 功能与命令详细手册

### 4.1 核心排版引擎
- **`\竖排[参数]{内容}`**: 将指定内容按垂直网格排列。
- **`\TextBox[参数]{内容}`**: 创建一个网格化的文本框。
    - `height`: 占据的行数（网格高度）。
    - `n-cols`: 内部细分列数（如一个大网格内排 3 列小字）。
    - `box-align`: 内容对齐方式（`top`, `center`, `bottom`, `fill`）。
- **`\Space[长度]`**: 插入网格占位符。

### 4.2 注释系统
- **`\TextFlow{内容}`** (别名: `\文本流`): 生成传统古籍的“夹注”（双行小字）。
- **`\SideNode[参数]{内容}`** (别名: `\侧批`): 在版面边缘添加注释。
    - `yoffset`: 垂直偏移量。
    - `color`: 注释颜色（古籍常为红色）。

### 4.3 装饰与定位
- **`\YinZhang[参数]{图片路径}`**: 在当前页插入绝对定位的印章。
    - `page`: 指定显示的页码。
    - `x`, `y`: 坐标位置（相对于页面左上角）。
    - `width`: 印章宽度。

### 4.4 段落控制
- **`\begin{Paragraph}[参数]`**:
    - `indent`: 全局缩进。
    - `first-indent`: 首行缩进（默认为 1 或 2 个字符）。
    - `bottom-indent`: 底部（右侧）留白。

### 4.5 全局配置 (`\gujiSetup`)
- `book-name`: 版心上方的书名。
- `chapter-title`: 版心中的章节名。
- `border`: 是否显示边框线（`true`/`false`）。
- `n-char`: 每行固定的字符数（古籍常见约束）。

---

## 5. 更多资源
如果你需要更深入的示例，请查看项目根目录下的 [示例/](../示例/) 文件夹。
