% Copyright 2026 Open-Guji (https://github.com/open-guji)
%
% Licensed under the Apache License, Version 2.0 (the "License");
% you may not use this file except in compliance with the License.
% You may obtain a copy of the License at
%
%     http://www.apache.org/licenses/LICENSE-2.0
%
% Unless required by applicable law or agreed to in writing, software
% distributed under the License is distributed on an "AS IS" BASIS,
% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
% See the License for the specific language governing permissions and
% limitations under the License.

% luatex-cn-guji-SiKuQuanShu-colored.cfg
% Siku Quanshu Colored Layout (四库全书彩色版)
% Inherits from default (black & white) and adds color settings

% =============================================================================
% Load base configuration (black & white version)
% =============================================================================
\gujiSetup{ template = SiKuQuanShu-colored }

\banxinSetup{
    banxin-upper-ratio = 0.32,  
    banxin-middle-ratio = 0.52, 
    chapter = { align = right },
}

% \注{content}
\NewDocumentCommand{\注}{ +m }{%
  \begin{段落}[indent=2]
    \夹注[auto-balance=false]{#1}%
  \end{段落}%
}

% 按环境 - Environment form to allow \平抬 expansion inside \按
\NewDocumentEnvironment{按环境}{}
  {\begin{段落}[indent=4]\begin{夹注环境}[auto-balance=false]}
  {\end{夹注环境}\end{段落}}

% \按{content} - Uses environment form internally to allow \平抬 expansion
\NewDocumentCommand{\按}{ +m }{%
  \begin{按环境}
    #1%
  \end{按环境}
}

\NewDocumentCommand{\國朝}{}{\相对抬头[1]{國朝}}

% \书名签{副标题内容}
% 封面上带双层边框的竖排标题框
% 例: \书名签{經部\空格[4] 簡明目錄卷一}
\NewDocumentCommand{\四库全书书名签}{ +m }{%
  \文本框[
    floating=true,
    x=15.3cm,
    y=0.3cm,
    grid-height=56pt,
    grid-width=92pt,
    border-shape=rect,
    border-width=2pt,
    border-margin=4pt,
    outer-border=true,
    outer-border-thickness=6pt,
    outer-border-sep=4pt,
    font-size=52pt,
    height=24cm
  ]{欽定四庫全書\夹注[align=center,font-size=20pt]{\样式[grid-height=24pt]{#1}}}%
}

\endinput

